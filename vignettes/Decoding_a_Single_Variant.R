## ----setup, include = FALSE---------------------------------------------------
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

## -----------------------------------------------------------------------------
require(kalis)
data("SmallHaps")

## -----------------------------------------------------------------------------
CacheHaplotypes(SmallHaps)

## -----------------------------------------------------------------------------
m <- rbeta(400-1,1,10)*1e-6
pars <- Parameters(CalcRho(cM = m, s = 1, gamma = 1), mu = 1e-8)

## -----------------------------------------------------------------------------
fwd <- MakeForwardTable(pars)
bck <- MakeBackwardTable(pars)

Forward(fwd, pars, 250)
Backward(bck, pars, 250)

## -----------------------------------------------------------------------------

p <- PostProbs(fwd,bck)
d <- DistMat(fwd,bck)


## ---- results='asis'----------------------------------------------------------
plot(d)

## ---- results='asis'----------------------------------------------------------
d <- 0.5*(d + t(d))
plot(d)

