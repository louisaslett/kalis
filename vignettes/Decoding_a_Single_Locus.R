## ----setup, include = FALSE---------------------------------------------------
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)

## -----------------------------------------------------------------------------
require(kalis)
data("SmallHaps")

## -----------------------------------------------------------------------------
CacheHaplotypes(SmallHaps)

## -----------------------------------------------------------------------------
m <- rbeta(500-1,1,10)*1e-6
pars <- Parameters(CalcRho(cM = m, s = 1, gamma = 1), mu = 1e-8)

## -----------------------------------------------------------------------------
fwd <- MakeForwardTable(pars)
bck <- MakeBackwardTable(pars)

Forward(fwd, pars, 250)
Backward(bck, pars, 250)

## -----------------------------------------------------------------------------

#p <- PostProbs(fwd,bck)
#M <- DistMat(fwd,bck)


## ---- results='asis'----------------------------------------------------------
#plot(M)

## ---- results='asis'----------------------------------------------------------
#M <- 0.5*(M + t(M))
#plot(M)

