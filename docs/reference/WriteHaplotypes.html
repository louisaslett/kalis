<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Write haplotype matrix to HDF5 file — WriteHaplotypes • kalis</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Write haplotype matrix to HDF5 file — WriteHaplotypes" />
<meta property="og:description" content="Writes an R matrix of 0/1s to the HDF5 format which is used for reading to
optimised in memory cache.  If you're working with a large haplotype dataset,
we recommend that you convert it directly to this HDF5 format (see vignette)
rather than read it into R." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">kalis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/Decoding_a_Single_Locus.html">Decoding a Single Locus</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/louisaslett/kalis/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Write haplotype matrix to HDF5 file</h1>
    <small class="dont-index">Source: <a href='https://github.com/louisaslett/kalis/blob/master/R/IndividualSequenceIO_H5.R'><code>R/IndividualSequenceIO_H5.R</code></a></small>
    <div class="hidden name"><code>WriteHaplotypes.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Writes an R matrix of 0/1s to the HDF5 format which is used for reading to
optimised in memory cache.  If you're working with a large haplotype dataset,
we recommend that you convert it directly to this HDF5 format (see vignette)
rather than read it into R.</p>
    </div>

    <pre class="usage"><span class='fu'>WriteHaplotypes</span><span class='op'>(</span>
  <span class='va'>hdf5.file</span>,
  <span class='va'>haps</span>,
  hap.ids <span class='op'>=</span> <span class='cn'>NA</span>,
  loci.ids <span class='op'>=</span> <span class='cn'>NA</span>,
  haps.name <span class='op'>=</span> <span class='st'>"/haps"</span>,
  hap.ids.name <span class='op'>=</span> <span class='st'>"/hap.ids"</span>,
  loci.ids.name <span class='op'>=</span> <span class='st'>"/loci.ids"</span>,
  append <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span>

<span class='fu'>ReadHaplotypes</span><span class='op'>(</span>
  <span class='va'>hdf5.file</span>,
  loci.idx <span class='op'>=</span> <span class='cn'>NA</span>,
  hap.idx <span class='op'>=</span> <span class='cn'>NA</span>,
  loci.ids <span class='op'>=</span> <span class='cn'>NA</span>,
  hap.ids <span class='op'>=</span> <span class='cn'>NA</span>,
  haps.name <span class='op'>=</span> <span class='st'>"/haps"</span>,
  loci.ids.name <span class='op'>=</span> <span class='st'>"/loci.ids"</span>,
  hap.ids.name <span class='op'>=</span> <span class='st'>"/hap.ids"</span>,
  transpose <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>hdf5.file</th>
      <td><p>the name of the file which the haplotypes are to be
written to.</p></td>
    </tr>
    <tr>
      <th>haps</th>
      <td><p>a vector or a matrix where each column is a haplotype to be
stored in the file <code>hdf5.file</code>.</p></td>
    </tr>
    <tr>
      <th>append</th>
      <td><p>a logical indicating whether overwrite (default) or append to
an existing <code>haps</code> dataset if it already exists in <code>hdf5.file</code>.</p></td>
    </tr>
    <tr>
      <th>ids</th>
      <td><p>a vector of the indices of which haplotypes are to be read.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>WriteIndividualHaplotypeH5</code> does not return anything.</p>
<p><code>ReadIndividualHaplotypeH5</code> returns a binary matrix containing the
haplotypes that were specified in <code>ids</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The primary method to load data into kalis' internal optimised cache is from
an HDF5 storage file.  If the user has a collection of haplotypes already
represented as a matrix of 0's and 1's in R, this function can be used to
write to HDF5 in the format required to load into cache.</p>
<p>kalis expects a 2-dimensional object named <code>haps</code> at the root
level of the HDF5 file.  Haplotypes should be stored in the slowest changing
dimension as defined in the HDF5 specification (note that different languages
treat this as rows or columns).</p>
<p>Note that if <code>hdf5.file</code> exists but does not contain a dataset named
<code>haps</code>, then <code>WriteIndividualHaplotypeH5</code> will simply create a
<code>haps</code> dataset within the existing file.</p>
    <h2 class="hasAnchor" id="functions"><a class="anchor" href="#functions"></a>Functions</h2>

    
<ul>
<li><p><code>ReadHaplotypes</code>: Read haplotype matrix from HDF5 file</p></li>
</ul>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='CacheHaplotypes.html'>CacheHaplotypes</a></code> to fill the kalis cache with haplotypes</p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># Examples</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># For the purposes of an example, generate random haplotypes ...</span>
<span class='va'>n.haps</span> <span class='op'>&lt;-</span> <span class='fl'>100</span>
<span class='va'>n.loci</span> <span class='op'>&lt;-</span> <span class='fl'>20000</span>
<span class='va'>haps</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/matrix.html'>matrix</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/sample.html'>sample</a></span><span class='op'>(</span><span class='fl'>0</span><span class='op'>:</span><span class='fl'>1</span>, <span class='va'>n.haps</span><span class='op'>*</span><span class='va'>n.loci</span>, replace <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
               nrow <span class='op'>=</span> <span class='va'>n.loci</span>,
               ncol <span class='op'>=</span> <span class='va'>n.haps</span><span class='op'>)</span>

<span class='co'># ... write them to a file ...</span>
<span class='fu'>WriteIndividualHaplotypeH5</span><span class='op'>(</span><span class='st'>"myhaps.h5"</span>, <span class='va'>haps</span><span class='op'>)</span>

<span class='co'># ... and confirm we can read a chosen portion back.  Try to read back</span>
<span class='co'># the 10th and 11th haplotypes</span>
<span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>ReadIndividualHaplotypeH5</span><span class='op'>(</span><span class='st'>"myhaps.h5"</span>, <span class='fl'>10</span><span class='op'>:</span><span class='fl'>11</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/base/all.html'>all</a></span><span class='op'>(</span><span class='va'>res</span> <span class='op'>==</span> <span class='va'>haps</span><span class='op'>[</span>, <span class='fl'>10</span><span class='op'>:</span><span class='fl'>11</span><span class='op'>]</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Louis Aslett, Ryan Christ.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


