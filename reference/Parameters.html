<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Define a set of Li and Stephens parameters — Parameters • kalis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/PT_Serif-0.4.10/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.10/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.10/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Define a set of Li and Stephens parameters — Parameters"><meta name="description" content="Specify a parameter set to be used for a particular Li and Stephens hidden Markov model run."><meta property="og:description" content="Specify a parameter set to be used for a particular Li and Stephens hidden Markov model run."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kalis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Decoding_a_Single_Variant.html">Decoding a Single Variant</a></li>
    <li><a class="dropdown-item" href="../articles/Iterating_Over_Loci.html">Iterating Over Loci</a></li>
    <li><a class="dropdown-item" href="../articles/lct_example.html">Reproducing kalis Paper LCT Example</a></li>
    <li><a class="dropdown-item" href="../articles/Reading_Haplotype_Data.html">Reading Haplotype Data</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1186/s12859-024-05688-8">BMC Bioinformatics Paper</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/louisaslett/kalis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Define a set of Li and Stephens parameters</h1>
      <small class="dont-index">Source: <a href="https://github.com/louisaslett/kalis/blob/master/R/Parameters.R" class="external-link"><code>R/Parameters.R</code></a></small>
      <div class="d-none name"><code>Parameters.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Specify a parameter set to be used for a particular Li and Stephens hidden Markov model run.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">Parameters</span><span class="op">(</span></span>
<span>  rho <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/get.html" class="external-link">get</a></span><span class="op">(</span><span class="st">"L"</span>, envir <span class="op">=</span> <span class="va">pkgVars</span><span class="op">)</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  mu <span class="op">=</span> <span class="fl">1e-08</span>,</span>
<span>  Pi <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  use.speidel <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  check.rho <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-rho">rho<a class="anchor" aria-label="anchor" href="#arg-rho"></a></dt>
<dd><p>recombination probability vector (must be \(L-1\) long).
See <code><a href="CalcRho.html">CalcRho()</a></code> for assistance constructing this from a recombination
map/distances.</p></dd>


<dt id="arg-mu">mu<a class="anchor" aria-label="anchor" href="#arg-mu"></a></dt>
<dd><p>a scalar (for uniform) or vector (for varying) mutation probabilities.</p></dd>


<dt id="arg-pi">Pi<a class="anchor" aria-label="anchor" href="#arg-pi"></a></dt>
<dd><p>leaving the default of uniform copying probabilities is recommended
for computational efficiency.
If desired, a full matrix of background copying probabilities can be provided, such that the <code>[j,i]</code>-th element is the background probability that <code>i</code> copies from <code>j</code>.
Hence, (a) the diagonal must be zero; and (b) the columns of <code>Pi</code> must sum to 1.
Note: each column corresponds to an independent Li and Stephens hidden Markov model.</p></dd>


<dt id="arg-use-speidel">use.speidel<a class="anchor" aria-label="anchor" href="#arg-use-speidel"></a></dt>
<dd><p>a logical, if <code>TRUE</code>, use the asymmetric mutation model used by RELATE (Speidel et al., 2019).
<strong>WARNING:</strong> this model assumes that the cached haplotypes have an ancestral/derived encoding – zeros denote ancestral variant carriers and ones denote derived variant carriers. Defaults to <code>FALSE</code>.</p></dd>


<dt id="arg-check-rho">check.rho<a class="anchor" aria-label="anchor" href="#arg-check-rho"></a></dt>
<dd><p>if <code>TRUE</code>, a check that rho is within machine precision will be performed.
If you have created rho using <code><a href="CalcRho.html">CalcRho()</a></code> with <code>floor = TRUE</code> then this will be satisfied automatically.
This can be important to ensure that the convex combination <code>rho</code> and <code>(1-rho)</code> normalises to 1 within machine precision, but an advanced user may wish to override this requirement.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <code>kalisParameters</code> object, suitable for use to create the standard forward and backward recursion tables with <code><a href="MakeForwardTable.html">MakeForwardTable()</a></code> and <code><a href="MakeBackwardTable.html">MakeBackwardTable()</a></code>.
Note you will also need to provide this parameters object when propagating those tables using either <code><a href="Forward.html">Forward()</a></code> or <code><a href="Backward.html">Backward()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>There are 3 parameters which must be specified before the forward or backward equations in the Li and Stephens hidden Markov model can be run.
These are the vector of recombination probabilities, the mutation probabilities, and the prior copying probabilities.</p>
<p><strong>NOTE:</strong> the corresponding haplotype data <em>must</em> have already been inserted into the kalis cache by a call to <code><a href="CacheHaplotypes.html">CacheHaplotypes()</a></code>, since this function performs checks to confirm the dimensionality matches.</p>
<p><strong>Recombination probabilities, <code>rho</code></strong></p>
<p>This is a vector parameter which must have length \(L-1\), where \(L\) is the number of variants that have been loaded into the kalis memory cache (using <code><a href="CacheHaplotypes.html">CacheHaplotypes()</a></code>).
Note that element <code>i</code> of this vector should be the recombination probability between variants <code>i</code> and <code>i+1</code>.</p>
<p>There is a utility function, <code><a href="CalcRho.html">CalcRho()</a></code>, to assist with creating these recombination probabilities from a recombination map.</p>
<p>By default, the recombination probabilities are set to zero everywhere.</p>
<p><strong>Mutation probabilities, <code>mu</code></strong></p>
<p>The mutation probabilities may be specified either as uniform across all variants (by providing a single scalar value), or may be varying at each variant (by providing a vector of length equal to the number of variants, \(L\), which have been loaded into the kalis memory cache).</p>
<p>By default, mutation probabilities are set to \(10^{-8}\).</p>
<p><strong>Copying probabilities, <code>Pi</code></strong></p>
<p>The original Li and Stephens model assumed that each haplotype has an equal prior probability of copying from any other.
However, in the spirit of ChromoPainter (Lawson et al., 2012) we allow a matrix of prior copying probabilities.</p>
<p>The copying probabilities may be specified as a standard R matrix of size \(N \times N\) (where \(N\) is the number of haplotypes which have been loaded into the kalis memory cache).
The element at row <code>j</code>, column <code>i</code> corresponds to the prior (background) probability that haplotype <code>i</code> copies from haplotype <code>j</code>.
Note that the diagonal must by definition be zero and columns must sum to one.
Alternatively, for uniform copying probabilities, this argument need not be specified (resulting in copying probability \(\frac{1}{N-1}\) everywhere).</p>
<p>Note that there is a computational cost associated with non-uniform copying probabilities, so it is recommended to leave the default of uniform probabilities when appropriate (<strong>Note:</strong> <em>do not</em> specify a uniform matrix when uniform probabilities are intended, since this would end up incurring the computational cost of non-uniform probabilities).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Aslett, L.J.M. and Christ, R.R. (2024) "kalis: a modern implementation of the Li &amp; Stephens model for local ancestry inference in R", <em>BMC Bioinformatics</em>, <strong>25</strong>(1). Available at: <a href="https://doi.org/10.1186/s12859-024-05688-8" class="external-link">doi:10.1186/s12859-024-05688-8</a>
.</p>
<p>Lawson, D.J., Hellenthal, G., Myers, S.R. and Falush, D. (2012) "Inference of population structure using dense haplotype data", <em>PLoS Genetics</em>, <strong>8</strong>(1). Available at: <a href="https://doi.org/10.1371/journal.pgen.1002453" class="external-link">doi:10.1371/journal.pgen.1002453</a>
.</p>
<p>Speidel, L., Forest, M., Shi, S. and Myers, S.R. (2019) "A method for genome-wide genealogy estimation for thousands of samples", <em>Nature Genetics</em>, <strong>51</strong>, p. 1321-1329. Available at: <a href="https://doi.org/10.1038/s41588-019-0484-x" class="external-link">doi:10.1038/s41588-019-0484-x</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MakeForwardTable.html">MakeForwardTable()</a></code> and <code><a href="MakeBackwardTable.html">MakeBackwardTable()</a></code> which construct table objects which internally reference a parameters environment;
<code><a href="Forward.html">Forward()</a></code> and <code><a href="Backward.html">Backward()</a></code> which propagate those tables according to the Li and Stephens model.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Load the mini example data and recombination map from the package built-in #' # dataset</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SmallHaps"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="st">"SmallMap"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Load haplotypes into cache</span></span></span>
<span class="r-in"><span><span class="fu"><a href="CacheHaplotypes.html">CacheHaplotypes</a></span><span class="op">(</span><span class="va">SmallHaps</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>haplotypes already cached ... overwriting existing cache.</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># To use all the defaults</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu">Parameters</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters object with:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rho   = (0, 0, 0, ..., 0, 0, 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mu    = 1e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pi    = 0.00334448160535117 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Or perhaps use SmallMap to compute the recombination probabilities, leaving</span></span></span>
<span class="r-in"><span><span class="co"># s and gamma as default</span></span></span>
<span class="r-in"><span><span class="va">rho</span> <span class="op">&lt;-</span> <span class="fu"><a href="CalcRho.html">CalcRho</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/diff.html" class="external-link">diff</a></span><span class="op">(</span><span class="va">SmallMap</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span> <span class="op">&lt;-</span> <span class="fu">Parameters</span><span class="op">(</span><span class="va">rho</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">pars</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Parameters object with:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   rho   = (0.030722976221863, 0.00188322071638501, 6.79809190046651e-06, ..., 1.56898508137998e-05, 1.7924679243824e-05, 1)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   mu    = 1e-08</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Pi    = 0.00334448160535117 </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then use these parameters to create a table (eg for forward) ...</span></span></span>
<span class="r-in"><span><span class="va">fwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="MakeForwardTable.html">MakeForwardTable</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... and to propagate it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="Forward.html">Forward</a></span><span class="op">(</span><span class="va">fwd</span>, <span class="va">pars</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">fwd</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Full Forward Table object for 300 haplotypes. </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Current variant = 10 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Memory consumed: 723.98 kB </span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Aslett, Ryan Christ.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

