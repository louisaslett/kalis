<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Create cache for forward tables — CreateForwardTableCache • kalis</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/PT_Serif-0.4.9/font.css" rel="stylesheet"><link href="../deps/JetBrains_Mono-0.4.9/font.css" rel="stylesheet"><link href="../deps/Roboto_Slab-0.4.9/font.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Create cache for forward tables — CreateForwardTableCache"><meta name="description" content="Create an in-memory cache for forward tables to improve efficiency when iterating in reverse along the haplotype sequences."><meta property="og:description" content="Create an in-memory cache for forward tables to improve efficiency when iterating in reverse along the haplotype sequences."><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">kalis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.0.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/Decoding_a_Single_Variant.html">Decoding a Single Variant</a></li>
    <li><a class="dropdown-item" href="../articles/Iterating_Over_Loci.html">Iterating Over Loci</a></li>
    <li><a class="dropdown-item" href="../articles/lct_example.html">Reproducing kalis Paper LCT Example</a></li>
    <li><a class="dropdown-item" href="../articles/Reading_Haplotype_Data.html">Reading Haplotype Data</a></li>
  </ul></li>
<li class="nav-item"><a class="external-link nav-link" href="https://doi.org/10.1186/s12859-024-05688-8">BMC Bioinformatics Paper</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/louisaslett/kalis/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Create cache for forward tables</h1>
      <small class="dont-index">Source: <a href="https://github.com/louisaslett/kalis/blob/master/R/TableCache.R" class="external-link"><code>R/TableCache.R</code></a></small>
      <div class="d-none name"><code>CreateForwardTableCache.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Create an in-memory cache for forward tables to improve efficiency when iterating in reverse along the haplotype sequences.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">CreateForwardTableCache</span><span class="op">(</span></span>
<span>  <span class="va">pars</span>,</span>
<span>  size <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  from_recipient <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  to_recipient <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>  max.tables <span class="op">=</span> <span class="fl">0</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-pars">pars<a class="anchor" aria-label="anchor" href="#arg-pars"></a></dt>
<dd><p>a <code>kalisParameters</code> object, as returned by <code><a href="Parameters.html">Parameters()</a></code>.</p></dd>


<dt id="arg-size">size<a class="anchor" aria-label="anchor" href="#arg-size"></a></dt>
<dd><p>the maximum amount of RAM (in GB) to devote to this cache.
By default, 1GB.</p></dd>


<dt id="arg-from-recipient">from_recipient<a class="anchor" aria-label="anchor" href="#arg-from-recipient"></a></dt>
<dd><p>first recipient haplotype if creating a partial forward table cache.
By default includes from the first recipient haplotype.</p></dd>


<dt id="arg-to-recipient">to_recipient<a class="anchor" aria-label="anchor" href="#arg-to-recipient"></a></dt>
<dd><p>last recipient haplotype if creating a partial forward table cache.
By default includes to the last recipient haplotype.</p></dd>


<dt id="arg-max-tables">max.tables<a class="anchor" aria-label="anchor" href="#arg-max-tables"></a></dt>
<dd><p>positive integer indicating the maximum number of tables to use in the cache.
Both this and <code>size</code> will be honoured, so the number of tables may be smaller than this.
By default, equals \(\lfloor\log_2(L)\rfloor\).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of forward tables representing a cache and ready to be filled is returned.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>If the objective is to run the Li and Stephens hidden Markov model both forwards and backwards to the same locus (and to do so for every possible locus), then considerable efficiency can be achieved by first performing a full scan forwards, filling a geometrically spaced cache whilst doing so.
Then, by working backwards, the backward propagation moves one locus at a time and the forward propagation can move backwards by moving forward from a recently cached local table.</p>
<p>Memory for a cache can be allocated using this function and should then be filled with <code><a href="FillTableCache.html">FillTableCache()</a></code>.
To use the cache, then instead of using the <code><a href="Forward.html">Forward()</a></code> function, use <code><a href="ForwardUsingTableCache.html">ForwardUsingTableCache()</a></code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Christ, R.R., Wang, X., Aslett, L.J.M., Steinsaltz, D. and Hall, I. (2024) "Clade Distillation for Genome-wide Association Studies", bioRxiv 2024.09.30.615852. Available at: <a href="https://doi.org/10.1101/2024.09.30.615852" class="external-link">doi:10.1101/2024.09.30.615852</a>
.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="MakeForwardTable.html">MakeForwardTable()</a></code> to make a forward table;
<code><a href="FillTableCache.html">FillTableCache()</a></code> to fill a cache;
<code><a href="ForwardUsingTableCache.html">ForwardUsingTableCache()</a></code> to use a cache;
<code><a href="Forward.html">Forward()</a></code> for forward function without using a cache.</p>
<p>Alternatively, see <code><a href="ForwardIterator.html">ForwardIterator()</a></code> to create an iterator which internally creates or uses a table cache.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="co"># This code assumes you have already:</span></span></span>
<span class="r-in"><span><span class="co">#  i) cached the haplotypes using CacheHaplotypes function</span></span></span>
<span class="r-in"><span><span class="co">#  ii) setup parameters in a variable called pars</span></span></span>
<span class="r-in"><span><span class="co">#  iii) set the number of loci in a variable called L</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Allocate up to 10GB to a cache, with parameters already setup in pars ...</span></span></span>
<span class="r-in"><span><span class="va">cache</span> <span class="op">&lt;-</span> <span class="fu">CreateForwardTableCache</span><span class="op">(</span><span class="va">pars</span>, <span class="fl">10</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># ... and fill it</span></span></span>
<span class="r-in"><span><span class="fu"><a href="FillTableCache.html">FillTableCache</a></span><span class="op">(</span><span class="va">cache</span>, <span class="va">pars</span>, nthreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create forward and backward tables</span></span></span>
<span class="r-in"><span><span class="va">fwd</span> <span class="op">&lt;-</span> <span class="fu"><a href="MakeForwardTable.html">MakeForwardTable</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">bck</span> <span class="op">&lt;-</span> <span class="fu"><a href="MakeBackwardTable.html">MakeBackwardTable</a></span><span class="op">(</span><span class="va">pars</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Then reach every locus faster by iterating backwards, using the cache to</span></span></span>
<span class="r-in"><span><span class="co"># move the forward table into position faster</span></span></span>
<span class="r-in"><span><span class="kw">for</span><span class="op">(</span><span class="va">l</span> <span class="kw">in</span> <span class="va">L</span><span class="op">:</span><span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="Backward.html">Backward</a></span><span class="op">(</span><span class="va">bck</span>, <span class="va">pars</span>, <span class="va">l</span>, nthreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="ForwardUsingTableCache.html">ForwardUsingTableCache</a></span><span class="op">(</span><span class="va">fwd</span>, <span class="va">pars</span>, <span class="va">cache</span>, <span class="va">l</span>, nthreads <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span></span>
<span class="r-in"><span>  <span class="co"># Do whatever work is required at</span></span></span>
<span class="r-in"><span>  <span class="co"># every locus here using fwd and bck</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Louis Aslett, Ryan Christ.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

